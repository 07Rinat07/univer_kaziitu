
<!--1. Отношение "Стоимость мест" (Room Rates)
Таблица для хранения стоимости мест в номерах, по классам номеров. Таблица будет включать "Класс"
номера и "Стоимость места".

sql

CREATE TABLE RoomRates (
    room_class VARCHAR(20),    -- Класс номера (например, 'эконом', 'люкс')
    rate DECIMAL(10, 2),       -- Стоимость места
    PRIMARY KEY (room_class)   -- Ключевое поле - класс номера
);
2. Отношение "Номера" (Rooms)
Таблица для хранения информации о номерах, включая идентификатор, класс (внешний ключ на таблицу 
RoomRates), количество мест в номере и количество забронированных мест.

sql

CREATE TABLE Rooms (
    room_id INT PRIMARY KEY,                      -- Идентификатор номера
    room_class VARCHAR(20),                       -- Класс номера (внешний ключ)
    total_seats INT,                              -- Количество мест в номере
    booked_seats INT,                             -- Количество забронированных мест
    FOREIGN KEY (room_class) REFERENCES RoomRates(room_class)
);
3. Отношение "Постояльцы" (Guests)
Таблица для хранения информации о постояльцах, включая номер паспорта, занимаемый номер, ФИО, пол, 
организацию, дату вселения и дату выселения.

sql

CREATE TABLE Guests (
    passport_number CHAR(10) PRIMARY KEY,         -- Номер паспорта (первичный ключ)
    room_id INT,                                  -- Номер, занимаемый постояльцем (внешний ключ)
    full_name VARCHAR(50) NOT NULL,               -- ФИО постояльца
    gender CHAR(1) DEFAULT 'М',                   -- Пол (по умолчанию - мужской)
    organization VARCHAR(60),                     -- Организация (по желанию)
    check_in_date DATE NOT NULL,                  -- Дата вселения (обязательное поле)
    check_out_date DATE,                          -- Дата выселения (заполняется при выезде)
    FOREIGN KEY (room_id) REFERENCES Rooms(room_id) -- Внешний ключ на номер
);
Л.р. №2. Выборка данных
1. Запрос на выдачу счета на оплату номера
Для выдачи счета на оплату необходимо учитывать количество дней проживания постояльца, класс номера 
и стоимость места. Запрос будет вычислять итоговую сумму на основе этих данных.

Предположим, что постоялец пребывает в гостинице с момента вселения до момента выселения, и стоимость
 рассчитывается за день.

sql

SELECT
    g.passport_number,                       -- Номер паспорта постояльца
    g.full_name,                             -- ФИО постояльца
    r.room_class,                            -- Класс номера
    rr.rate AS room_rate,                    -- Стоимость места
    DATEDIFF(g.check_out_date, g.check_in_date) AS days_stayed, -- Количество дней проживания
    rr.rate * DATEDIFF(g.check_out_date, g.check_in_date) AS total_amount  -- Общая сумма
FROM Guests g
JOIN Rooms r ON g.room_id = r.room_id
JOIN RoomRates rr ON r.room_class = rr.room_class
WHERE g.check_out_date IS NOT NULL;        -- Для постояльцев, которые уже выселились
Этот запрос выдает информацию о постояльцах, сроках их проживания и рассчитанную сумму за проживание 
на основе количества дней и стоимости места в соответствующем классе номера.

2. Создание упорядоченных списков
2.1. Список свободных номеров (по классу и номерам) с указанием общего количества мест в номере
Для получения списка свободных номеров, можно использовать следующий запрос:

sql

SELECT
    r.room_id,                             -- Идентификатор номера
    r.room_class,                          -- Класс номера
    r.total_seats,                         -- Общее количество мест
    (r.total_seats - r.booked_seats) AS free_seats  -- Количество свободных мест
FROM Rooms r
WHERE r.total_seats > r.booked_seats       -- Номера, в которых есть свободные места
ORDER BY r.room_class, r.room_id;          -- Сортировка по классу и номеру
Этот запрос выдает список свободных номеров, упорядоченных по классу и номеру. В нем также 
отображается общее количество мест в номере и количество оставшихся свободных мест.

2.2. Список полностью забронированных номеров
Чтобы получить список номеров, которые полностью забронированы, нужно использовать следующий запрос:

sql

SELECT
    r.room_id,                             -- Идентификатор номера
    r.room_class,                          -- Класс номера
    r.total_seats                           -- Общее количество мест
FROM Rooms r
WHERE r.total_seats = r.booked_seats      -- Номера, в которых все места забронированы
ORDER BY r.room_class, r.room_id;         -- Сортировка по классу и номеру
Этот запрос возвращает все номера, где количество забронированных мест равно общему количеству мест 
в номере, то есть такие номера полностью забронированы.-->